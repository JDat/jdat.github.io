<!DOCTYPE html>
<html lang="en">
<head>
    <title>SondeRecovery</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <p id="demo"></p>

    <script>
        let url = window.document.URL;
        url = url.split('#')[1];
        let paramArray = url.split(',');
        var paramObj = [];
        for (key in paramArray) {
            //paramObj.push(paramArray[key].split('='));
            let paramName = paramArray[key].split('=')[0];
            let paramValue = paramArray[key].split('=')[1];
            paramObj[paramName] = paramValue;
        }
        const d = new Date;
        let t = d.toISOString();
        let data = `{"datetime: "` + t + `",
            "serial: "` + paramObj.sondeID + `",
            "lat: "` + paramObj.sondeLat + `",
            "lon: "` + paramObj.sondeLon + `",
            "alt: "` + paramObj.sondeAlt + `",
            "recovered: "` + true + `",
            "recovered_by: "` + paramObj.callSign + `",
            "description: "` + `"cool!"
        }`;
        document.getElementById("demo").innerHTML = data;
        //document.getElementById("demo").innerHTML = url;
        
        let xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function () {
           if (xhr.readyState === 4) {
              //console.log(xhr.status);
              //console.log(xhr.statusText);
              //console.log(xhr.responseText.toString());
           }};

        //xhr.open("PUT", url);
        //xhr.setRequestHeader("Content-Type", "application/json");
        //xhr.setRequestHeader("Date", t);
        //xhr.setRequestHeader("User-Agent", "kgTrack-0.0.1");
        //xhr.send(data);
    </script>
</body>
</html>
